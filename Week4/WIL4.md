# Week4

---

### Object Detection

---

이번 주차는 다양한 객체를 한번에 판별하는 Object Detection 을 다루게 되었다.  
이전까지는 이미지 하나에 대해 식별하는 인공지능을 다루었다.  
하지만, 여러 객체를 다루게 되면서, 우리는 객체의 위치와 종류라는 두가지 과제가 생기게 되었다.  
이를 해결하는 방법을 알아보았다.  

여기서 핵심은 객체의 위치 및 크기를 정확하게 구분하는 것이다.  
왜냐하면, 구분 후에는 다양한 객체에 대한 식별이 하나의 객체에 대한 식별로 바뀌기 때문이다.  
하나로 구분된 객체에 대해서는 이전에 배운 방법을 써도 괜찮을 것 같다.

위치와 크기를 구분하는 방법에는 다양한 시도가 있었다.  
가장 단순한 방법은 모든 pixal 을 살펴보는 일종의 브루트포스일 것이다.  
하지만, 이 방법은 이미지가 약간만 커도 너무 많은 연산을 하는 비효율적일 것이다.

그래서 후보를 선정해야겠다는 생각에 이르게 된다.

그 방법으로 Selective Search 를 활용하였다. 정해진 후보들에 대해 모두 신경망을 통해 객체 구분을 해주었다.  
이것을 R-CNN(Regional-Based CNN) 이라고 한다.
하지만… 이 방법은 모든 후보에 대해 따로따로 신경망을 거쳐야한다는 단점이 존재했다.

이 때문에 한번에 신경망을 통과시키고, 통과된 feature map 에서 객체의 위치와 종류를 구하고자 했다.  
이러한 모델을 Fast R-CNN 이라고 한다.  
이 방법의 단점은 신경망을 통과한 feature map 에서는 위치 정보를 구할 수 없다는 것이다.  
이에 원본 이미지에서의 위치 정보를 feature map 과 연결하는 추가 과정이 필요했다.
여태까지는 위치정보를 Selective Search 라는 알고리즘을 통해 구했다.  
하지만, 이 방법은 전체 알고리즘에서 상당한 시간을 차지하고 있었다.

이를 해결하는 방법으로 RPN(Region Proposal Network) 를 도입하게 되었다.  
기존의 Selective Search 는 cpu에서 일어나는 방법으로, 병목현상으로 인해 시간이 많이 소요됬다.  
하지만, RPN은 conv 을 사용하므로 gpu에서 병목 현상 없이 사용가능하다.  
RPN은 내부적으로 객체의 존재 여부와 그 크기를 전달해준다.  

여기까지가 Object Detection 을 위한 기계학습 모델이었다.

### F1-Score

---

모델의 성능을 평가하기 위해서 종종 사용되는 지표 중에 F1-Score 라는 지표가 존재하는데,  
관련 내용이 항상 헷갈리므로 한 번 정리하고자 한다.

F1-Score 는 데이터가 **불균형** 하다고 판단될 때, 모델의 성능을 평가하기 위한 지표이다.  
F1-Score 에는 Accuracy 와 Recall 두가지로 구성되어 있다.

Accuracy 와 Recall 을 표현하는 때는 True/False, Positive/Negative 가 필요하다.  

True/False 는 실제값과 일치하면 True, 틀리면 False이다.  
틀린것을 틀렸다고 한 것 또한 True 라고 할 수 있다.

Positive/Negative 는 순수 모델의 평가를 기준으로 맞다고 평가했다면 Positive,  
틀렸다고 판단하면 Negative 이다.

- Accuracy
    
    의미 그대로 정확도이다. 즉, 모델이 **평가**한 결과중 **실제로** 맞는 것 간에 비율이다.  
    즉, $\frac{TP}{TP + FP}$ 이다. (맞다고 판단한 것 중 실제로 맞는 것)
    
- Recall
    
    Accuracy 는 모델의 평가를 기준으로 했다면, Recall 은 실제값을 기준으로 한다.  
    즉, 실제 True 값 중 모델이 True라고 판단한 것이다.  
    $\frac{TP}{TP+FN}$ 이다. (FN 은 모델이 Negative 라고 판단했으나 False 틀린 것이므로 실제 값은 True 이다.)  
    

즉, 두 지표는 각각 모델과 현실을 기준으로 판단하므로 적절히 섞으면, 좋은 지표가 나올 것도 같다.  
그래서 F1-Score 는 두 지표의 **조화평균** 이다.  
근데 왜 하필 조화평균일까? 이는 더 작은 값에 영향을 받기 위함이라고 한다.  
F1-Score 의 취지는 모델의 평가를 위한 것이다. 즉, 잘하는 것이 아니라 못한 것을 강조해야 하므로,  
작은 값에 영향을 받도록 조화평균을 사용했다.

밑은 F1-Score 에 대해 참고한 자료이다.

[https://velog.io/@jadon/F1-score란](https://velog.io/@jadon/F1-score%EB%9E%80)